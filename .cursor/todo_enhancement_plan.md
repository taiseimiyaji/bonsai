# TODOリスト機能改善計画

## データモデルの拡張

- [x] Prismaスキーマの更新
  - [x] `Todo`モデルに以下のフィールドを追加
    - [x] `dueDate`: 期限日（DateTime?）
    - [x] `priority`: 優先度（Enum: HIGH, MEDIUM, LOW）
    - [x] `categoryId`: カテゴリID（外部キー）
    - [x] `parentId`: 親タスクID（自己参照）
    - [x] `order`: 表示順序（Int）
    - [x] `status`: ステータス（Enum: TODO, IN_PROGRESS, DONE）
  - [x] `TodoCategory`モデルの作成
    - [x] `id`: カテゴリID
    - [x] `name`: カテゴリ名
    - [x] `color`: カテゴリの色
    - [x] `userId`: ユーザーID（外部キー）

## バックエンド実装

- [x] tRPCアクションの拡張
  - [x] `todo.ts`アクションの更新
    - [x] 期限日の設定・取得
    - [x] 優先度の設定・取得
    - [x] カテゴリの設定・取得
    - [x] サブタスクの作成・取得
    - [x] タスクの並び替え
    - [x] ステータス変更
  - [x] カテゴリ関連のアクション追加
    - [x] カテゴリの作成
    - [x] カテゴリの更新
    - [x] カテゴリの削除
    - [x] カテゴリ一覧の取得
  - [x] フィルタリング・ソート機能
    - [x] 期限日でのフィルタリング
    - [x] 優先度でのフィルタリング
    - [x] カテゴリでのフィルタリング
    - [x] ステータスでのフィルタリング
    - [x] キーワード検索

- [x] tRPCルーターの更新
  - [x] 新しいエンドポイントの追加
  - [x] 入力バリデーションの更新

## フロントエンド実装

- [ ] コンポーネント構造の再設計
  - [ ] `TodosPage.client.tsx`の分割
    - [ ] `TodoList.tsx`: リスト表示コンポーネント
    - [ ] `TodoKanban.tsx`: カンバン表示コンポーネント
    - [ ] `TodoForm.tsx`: タスク作成・編集フォーム
    - [ ] `TodoItem.tsx`: 個別タスク表示
    - [ ] `TodoFilter.tsx`: フィルタリングUI
    - [ ] `TodoCategory.tsx`: カテゴリ管理UI

- [ ] UI/UX改善
  - [ ] ヘッダー・ナビゲーション
    - [ ] 表示モード切替（リスト/カンバン）
    - [ ] フィルター・ソートオプション
    - [ ] 検索機能
  - [ ] タスク作成フォーム
    - [ ] タイトル入力
    - [ ] 説明入力
    - [ ] 期限日選択（DatePicker）
    - [ ] 優先度選択
    - [ ] カテゴリ選択
    - [ ] 親タスク選択（サブタスク作成時）
  - [ ] タスク表示
    - [ ] 期限日の視覚的表示（期限切れは赤、間近は黄色など）
    - [ ] 優先度による色分け
    - [ ] カテゴリタグの表示
    - [ ] サブタスクの階層表示
    - [ ] 進捗率の表示（サブタスクがある場合）
  - [ ] リスト表示
    - [ ] ドラッグ&ドロップでの並べ替え（@dnd-kit/sortable）
    - [ ] 展開/折りたたみ可能なサブタスク
    - [ ] ソート機能（期限日、優先度、作成日など）
  - [ ] カンバン表示
    - [ ] 「未着手」「進行中」「完了」の3列表示
    - [ ] 列間のドラッグ&ドロップ
    - [ ] 列内での並べ替え

- [ ] 状態管理
  - [ ] フィルター状態の管理
  - [ ] 表示モードの管理
  - [ ] ドラッグ&ドロップ状態の管理
  - [ ] フォーム状態の管理

## 追加機能実装

- [ ] ダークモード対応
  - [ ] システム設定連動
  - [ ] 手動切り替え
  - [ ] ダークモード用のカラースキーム

- [ ] レスポンシブデザイン
  - [ ] モバイル対応レイアウト
  - [ ] タブレット対応レイアウト

## テスト・デバッグ

- [ ] 単体テスト
  - [ ] バックエンド（tRPCアクション）
  - [ ] フロントエンド（React コンポーネント）

- [ ] 統合テスト
  - [ ] エンドツーエンドのユーザーフロー

## デプロイ・リリース

- [ ] データベースマイグレーション
- [ ] 段階的なリリース計画
  - [ ] フェーズ1: 基本機能（期限日、優先度）
  - [ ] フェーズ2: カテゴリ、サブタスク
  - [ ] フェーズ3: UI/UX改善（ドラッグ&ドロップ、カンバン表示）
  - [ ] フェーズ4: 検索・フィルタリング
  - [ ] フェーズ5: ダークモード対応
